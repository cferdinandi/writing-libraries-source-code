<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title>Universal Module Definition (UMD)</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- Styles -->
		<style type="text/css">
			body {
				max-width: 40em;
				width: 88%;
				margin-left: auto;
				margin-right: auto;
			}

			.accordion,
			.accordion-alt {
				display: none;
			}

			.accordion.active,
			.accordion-alt.is-open {
				display: block;
			}
		</style>
	</head>

	<body>

		<p><a class="accordion-toggle" href="#content-1">Show More 1</a></p>

		<div class="accordion" id="content-1">
			<p>Some content...</p>
		</div>

		<p><a class="accordion-toggle" href="#content-2">Show More 2</a></p>

		<div class="accordion" id="content-2">
			<p>Some more content...</p>
		</div>

		<p><a class="accordion-toggle" href="#content-3">Show More 3</a></p>

		<div class="accordion" id="content-3">
			<p>Even more content...</p>
		</div>

		<hr>

		<p><a class="accordion-toggle-alt" href="#content-1-alt">Show More 1</a></p>

		<div class="accordion-alt" id="content-1-alt">
			<p>Some content...</p>
		</div>

		<p><a class="accordion-toggle-alt" href="#content-2-alt">Show More 2</a></p>

		<div class="accordion-alt" id="content-2-alt">
			<p>Some more content...</p>
		</div>

		<p><a class="accordion-toggle-alt" href="#content-3-alt">Show More 3</a></p>

		<div class="accordion-alt" id="content-3-alt">
			<p>Even more content...</p>
		</div>


		<!-- Scripts -->
		<script>
			(function (root, factory) {
				if ( typeof define === 'function' && define.amd ) {
					define([], function () {
						return factory(root);
					});
				} else if ( typeof exports === 'object' ) {
					module.exports = factory(root);
				} else {
					root.Accordion = factory(root);
				}
			})(typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : this, function (window) {

				'use strict';

				// Element.matches() polyfill (simple version)
				// https://developer.mozilla.org/en-US/docs/Web/API/Element/matches#Polyfill
				if (!Element.prototype.matches) {
					Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
				}

				// Defaults
				var defaults = {
					// Selectors
					selectorContent: '.accordion',

					// Classes
					toggleClass: 'active',
					contentClass: 'active',
					init: 'js-accordion'
				};

				/*!
				 * Merge two or more objects together.
				 * (c) 2017 Chris Ferdinandi, MIT License, https://gomakethings.com
				 * @param   {Boolean}  deep     If true, do a deep (or recursive) merge [optional]
				 * @param   {Object}   objects  The objects to merge together
				 * @returns {Object}            Merged values of defaults and options
				 */
				var extend = function () {

					// Variables
					var extended = {};
					var deep = false;
					var i = 0;

					// Check if a deep merge
					if ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {
					    deep = arguments[0];
					    i++;
					}

					// Merge the object into the extended object
					var merge = function (obj) {
						for (var prop in obj) {
							if (obj.hasOwnProperty(prop)) {
								// If property is an object, merge properties
								if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {
									extended[prop] = extend(extended[prop], obj[prop]);
								} else {
									extended[prop] = obj[prop];
								}
							}
						}
					};

					// Loop through each object and conduct a merge
					for (; i < arguments.length; i++) {
						var obj = arguments[i];
						merge(obj);
					}

					return extended;

				};

				// Our plugin constructor
				// Can be named anything you want
				var BuildAccordion = function (selector, options) {

					// Variables
					var publicAPIs = {}; // Our public APIs
					var settings; // Settings

					// Check if the target content is already active
					var isActive = function (content, toggle) {
						if (content.classList.contains(settings.contentClass)) {
							content.classList.remove(settings.contentClass);
							toggle.classList.remove(settings.toggleClass);

							// Dispatch a custom event
							if (typeof window.CustomEvent === 'function') {
								var event = new CustomEvent('accordionClose', {
									bubbles: true,
									detail: {
										toggle: toggle
									}
								});
								content.dispatchEvent(event);
							}

							return true;
						}
					};

					// Close all items with a matching selector
					var closeItems = function (selector, activeClass) {
						var items = document.querySelectorAll(selector);
						for (var i = 0; i < items.length; i++) {
							items[i].classList.remove(activeClass);

							// Dispatch a custom event
							if (selector === settings.selectorContent) {
								if (typeof window.CustomEvent === 'function') {
									var event = new CustomEvent('accordionClose', {
										bubbles: true,
										detail: {
											toggle: null
										}
									});
									items[i].dispatchEvent(event);
								}
							}
						}
					};

					// Close all accordions and toggles
					publicAPIs.closeAccordions = function () {
						closeItems(settings.selectorContent, settings.contentClass);
						closeItems(selector, settings.toggleClass);
					};

					// Run our accordion script
					var runAccordion = function () {
						// Only run if the clicked link was an accordion toggle
						if (!event.target.matches(selector)) return;

						// Get the target content
						var content = document.querySelector(event.target.hash);
						if (!content) return;

						// Prevent default link behavior
						event.preventDefault();

						// If the content is already expanded, collapse it and quit
						var expanded = isActive(content, event.target);
						if (expanded) return;

						// Close all accordion content and toggles
						publicAPIs.closeAccordions();

						// Open our target content area and toggle link
						content.classList.add(settings.contentClass);
						event.target.classList.add(settings.toggleClass);


						// Dispatch a custom event
						if (typeof window.CustomEvent === 'function') {
							var customEvent = new CustomEvent('accordionOpen', {
								bubbles: true,
								detail: {
									toggle: event.target
								}
							});
							content.dispatchEvent(customEvent);
						}
					};

					publicAPIs.destroy = function () {
						// Only run if settings is set
						if (!settings) return;

						// Remove event listener
						document.removeEventListener('click', runAccordion, false);

						// Remove the initialization class
						document.documentElement.classList.remove(settings.init);

						// Reset settings
						settings = null;
					};

					// Initialize our plugin
					publicAPIs.init = function (options) {
						// Feature test
						var supports = 'querySelector' in document && 'addEventListener' in window;
						if (!supports) return;

						// Destroy any previous initializations
						publicAPIs.destroy();

						// Merge user options with the defaults
						settings = extend(defaults, options || {});

						// Listen for click events
						document.addEventListener('click', runAccordion, false);

						// Add our initialization class
						document.documentElement.className += ' ' + settings.init;
					};

					// Initialize the plugin
					publicAPIs.init(options);


					// Return the public APIs
					return publicAPIs;

				};

				// Return the constructor
				return BuildAccordion;

			});

			// Instance 1
			var accordion = new Accordion('.accordion-toggle');

			// Instance 2
			var accordionAlt = new Accordion('.accordion-toggle-alt', {
				selectorContent: '.accordion-alt',
				contentClass: 'is-open'
			});
		</script>
	</body>
</html>